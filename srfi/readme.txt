taken from taylanubs repo

based on the reference implementations

modified slightly

